#!/bin/sh

#####################################################
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏░▒▒▒▒▒▒▒▒░▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏░░░░░░▒▒░▒▒▒▒▒▒░░░░░▏▏▏▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏░▒▓█▒░░░░░░▒▒▒▒░░░░░░▓░▏▏▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏▏▏░▓▒░░░░▒░▒▒██▓▓▓▓▓░░░░░░░░▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏░▒▓░░░▒██▒░░░▒▒░░░░░░░░░░▒▒▒▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏▏▏░█▒░░▒███▒░░░▒░░░░▓▓▓░░░░▒█░▏▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏░░░░░░▓▓███▓▒▓▓█▒░░░▓▓▓░░░░░░▒░▏▏▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏▏▏░▒░░▒███████████▒░░░▓▓▓░░░░░░▒▓▒░▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏▏░▒░░░▒▓███████████▓░░░▒▓▓░░░▓░░░▓▒▒▏▏▏▏▏▏#
# ▏▏▏▏▏▏▏▏░░░░░▒▒▒████████████░░░░░░░░░█▒░░▒▒▒▏▏▏▏▏▏#
# ▏▏▏▏▏▏░▓▒░░░▓▒░░▓███████████▒▓░░░░░░▓█░░░▓▒▒▏▏▏▏▏▏#
# ▏▏▏▏▏░░░░░▒▒█▒▒░░▒▒▒▒▒████████▒░░░▒██▒░░▒▓▒░▏▏▏▏▏▏#
# ▏▏░░░░░░░▒█████▒░░░░░░▒▒▒▒███████████▒░░▒▒▏▏▏▏▏▏▏▏#
# ░▓▒░░░░░░▓▓▓▓▓▓░░░░░░░░░░░░░▓▓▓▓▓▓▓▓▓░░░▒▒▏▏▏▏▏▏▏▏#
# ▒▒▒░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▒▒▏▏▏▏▏▏▏▏#
#####################################################

clear=$(printf "\033[2J");
clear2=$(printf "\033[3J");
home=$(printf "\033[H");
notifId="";
while [ true ]; do
	read in;
	if [[ $in == *"$clear"* ]]; then
		img=${img/$'\033[2J'/""};
		img=${img/$'\033[3J'/""};
		img=${img/$'\033[H'/""};

		img=$(echo "$img" | sed -e "s/.\\[..m//g")

		# Notifications usually don't use monospaced fonts, this is a way of forcing them
		img=$(echo "$img" | sed \
			-e "s/ /▏/g" \
			-e "s/[.:;',]/░/g" \
			-e "s/[coN]/▒/g" \
			-e "s/[ld0]/▓/g" \
			-e "s/[a-zA-Z]/█/g"
		)

		echo "$img";
		if [[ "$notifId" == "" ]]; then
			notifId=$(notify-send "$img" -p)
		else
			notify-send "$img" -r "$notifId"
		fi
		img="";
	fi
	img="${img}"$'\n'"${in/$'\033[39m'/$''}";
done < <(curl --silent --no-buffer parrot.live)
